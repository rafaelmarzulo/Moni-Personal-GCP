{% set app_name = "Sistema de Reavaliação Física MoniPersonal" %}
<!doctype html>
<html lang="pt-br">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{% block title %}Admin • {{ app_name }}{% endblock %}</title>

    <!-- Favicon -->
    <link rel="icon" type="image/png" sizes="192x192" href="{{ url_for('static', path='img/favicons/favicon-192x192.png') }}">
    <link rel="icon" type="image/png" href="{{ url_for('static', path='favicon.png') }}">
    <link rel="shortcut icon" href="{{ url_for('static', path='favicon.png') }}">

    <!-- Bootstrap Dark Theme -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap-dark-5@1.1.3/dist/css/bootstrap-dark.min.css"
      rel="stylesheet"
      crossorigin="anonymous"
    >

    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">

    <!-- Tema MoniPersonal -->
    <link rel="stylesheet" href="{{ url_for('static', path='css/theme.css') }}?v=3.0">

    <!-- CSS Admin -->
    <style>
    :root {
      --primary-dark: #1a1a1a;
      --primary-gold: #d4af37;
      --primary-rose: #d63384;
      --primary-purple: #6f42c1;
      --gradient-main: linear-gradient(135deg, var(--primary-purple), var(--primary-rose));
      --sidebar-width: 250px;
    }

    body {
      background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%) !important;
      font-family: 'Inter', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      color: #ffffff !important;
    }

    /* Sidebar */
    .admin-sidebar {
      position: fixed;
      top: 0;
      left: 0;
      height: 100vh;
      width: var(--sidebar-width);
      background: var(--gradient-main);
      border-right: 1px solid rgba(255, 255, 255, 0.1);
      overflow-y: auto;
      z-index: 1000;
    }

    .sidebar-header {
      padding: 1.5rem 1rem;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      text-align: center;
    }

    .sidebar-logo {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      border: 2px solid var(--primary-gold);
      margin-bottom: 0.5rem;
    }

    .sidebar-title {
      color: white;
      font-size: 1.1rem;
      font-weight: 600;
      margin: 0;
    }

    .sidebar-nav {
      padding: 1rem 0;
    }

    .nav-item {
      margin-bottom: 0.5rem;
    }

    .nav-link {
      display: flex;
      align-items: center;
      padding: 0.75rem 1.5rem;
      color: rgba(255, 255, 255, 0.8) !important;
      text-decoration: none;
      border: none;
      background: none;
      transition: all 0.3s ease;
    }

    .nav-link:hover, .nav-link.active {
      background: rgba(255, 255, 255, 0.1);
      color: white !important;
      border-right: 3px solid var(--primary-gold);
    }

    .nav-link i {
      margin-right: 0.75rem;
      width: 20px;
      text-align: center;
    }

    /* Main content */
    .admin-content {
      margin-left: var(--sidebar-width);
      min-height: 100vh;
      padding: 2rem;
    }

    /* Header do conteúdo */
    .content-header {
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      border-radius: 15px;
      padding: 1.5rem;
      margin-bottom: 2rem;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .content-title {
      margin: 0;
      color: white;
      font-size: 1.8rem;
      font-weight: 600;
    }

    .content-subtitle {
      margin: 0.5rem 0 0 0;
      color: rgba(255, 255, 255, 0.7);
    }

    /* Cards admin */
    .admin-card {
      border: none !important;
      border-radius: 20px !important;
      box-shadow: 0 8px 32px rgba(214, 51, 132, 0.3) !important;
      transition: all 0.3s ease !important;
      background: rgba(255, 255, 255, 0.1) !important;
      backdrop-filter: blur(10px) !important;
      margin-bottom: 2rem !important;
    }

    .admin-card:hover {
      transform: translateY(-5px) !important;
      box-shadow: 0 15px 50px rgba(214, 51, 132, 0.4) !important;
    }

    /* Overlay para mobile */
    .sidebar-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      z-index: 999;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
    }

    .sidebar-overlay.show {
      opacity: 1;
      visibility: visible;
    }

    /* Responsivo */
    @media (max-width: 768px) {
      .admin-sidebar {
        transform: translateX(-100%);
        transition: transform 0.3s ease;
        z-index: 1001;
      }

      .admin-sidebar.show {
        transform: translateX(0);
      }

      .admin-content {
        margin-left: 0;
        padding: 1rem;
        padding-top: 4rem; /* Espaço para o botão mobile */
      }

      .content-header {
        margin-top: 0;
      }
    }

    /* Checkboxes compatíveis com tema dark */
    .form-check-input {
      appearance: auto !important;
      -webkit-appearance: checkbox !important;
      width: 1.2em !important;
      height: 1.2em !important;
      background-color: #fff !important;
      border: 2px solid #6c757d !important;
      opacity: 1 !important;
      visibility: visible !important;
      display: inline-block !important;
    }

    .form-check-input:checked {
      background-color: var(--primary-purple) !important;
      border-color: var(--primary-purple) !important;
    }
    </style>

    {% block head_extra %}{% endblock %}
  </head>
  <body>
    <!-- Overlay para mobile -->
    <div class="sidebar-overlay" id="sidebar-overlay"></div>

    <!-- Sidebar -->
    <nav class="admin-sidebar">
      <div class="sidebar-header">
        <img
          src="{{ url_for('static', path='img/logo-monipersonal.png') }}"
          alt="MoniPersonal"
          class="sidebar-logo"
        >
        <h6 class="sidebar-title">Painel Admin</h6>
      </div>

      <div class="sidebar-nav">
        <div class="nav-item">
          <a class="nav-link" href="/admin/alunos">
            <i class="bi bi-people-fill"></i>
            Gerenciar Alunos
          </a>
        </div>
        <div class="nav-item">
          <a class="nav-link" href="/admin/reset-passwords">
            <i class="bi bi-key-fill"></i>
            Reset de Senhas
          </a>
        </div>
        <div class="nav-item">
          <a class="nav-link" href="/admin/avaliacoes">
            <i class="bi bi-clipboard-data-fill"></i>
            Todas Avaliações
          </a>
        </div>
        <div class="nav-item">
          <a class="nav-link" href="/admin/relatorios">
            <i class="bi bi-graph-up"></i>
            Relatórios
          </a>
        </div>
        <div class="nav-item">
          <a class="nav-link" href="/debug/logs">
            <i class="bi bi-bug-fill"></i>
            Logs do Sistema
          </a>
        </div>
        <div class="nav-item">
          <a class="nav-link" href="/admin/backup">
            <i class="bi bi-shield-check"></i>
            Criar Backup
          </a>
        </div>

        <hr style="border-color: rgba(255, 255, 255, 0.2); margin: 1rem 1.5rem;">

        <div class="nav-item">
          <a class="nav-link" href="/admin/nova-avaliacao">
            <i class="bi bi-plus-circle-fill"></i>
            Nova Avaliação
          </a>
        </div>
        <div class="nav-item">
          <a class="nav-link" href="/logout">
            <i class="bi bi-box-arrow-right"></i>
            Sair
          </a>
        </div>
      </div>
    </nav>

    <!-- Main Content -->
    <main class="admin-content">
      <div class="content-header">
        <h1 class="content-title">{% block page_title %}Painel Administrativo{% endblock %}</h1>
        <p class="content-subtitle">{% block page_subtitle %}Sistema MoniPersonal{% endblock %}</p>
      </div>

      <div class="admin-main">
        {% block content %}{% endblock %}
      </div>
    </main>

    <!-- Mobile toggle -->
    <button id="mobile-sidebar-toggle" class="btn btn-primary d-md-none" style="position: fixed; top: 1rem; left: 1rem; z-index: 1001;">
      <i class="bi bi-list"></i>
    </button>

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      crossorigin="anonymous"
    ></script>

    <!-- Script para controle do sidebar mobile -->
    <script>
    document.addEventListener('DOMContentLoaded', function() {
      const toggleButton = document.getElementById('mobile-sidebar-toggle');
      const sidebar = document.querySelector('.admin-sidebar');
      const overlay = document.getElementById('sidebar-overlay');

      if (toggleButton && sidebar && overlay) {
        // Função para abrir/fechar sidebar
        function toggleSidebar() {
          sidebar.classList.toggle('show');
          overlay.classList.toggle('show');
        }

        // Função para fechar sidebar
        function closeSidebar() {
          sidebar.classList.remove('show');
          overlay.classList.remove('show');
        }

        // Clique no botão toggle
        toggleButton.addEventListener('click', function(e) {
          e.stopPropagation();
          toggleSidebar();
        });

        // Clique no overlay fecha o sidebar
        overlay.addEventListener('click', closeSidebar);

        // Clique nos links do sidebar fecha o menu no mobile
        const navLinks = sidebar.querySelectorAll('.nav-link');
        navLinks.forEach(function(link) {
          link.addEventListener('click', function() {
            if (window.innerWidth <= 768) {
              closeSidebar();
            }
          });
        });

        // Fechar sidebar ao redimensionar para desktop
        window.addEventListener('resize', function() {
          if (window.innerWidth > 768) {
            closeSidebar();
          }
        });
      }
    });
    </script>

    {% block scripts %}{% endblock %}
  </body>
</html>